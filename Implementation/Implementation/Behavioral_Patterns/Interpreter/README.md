**Название и классификация паттерна﻿**
 
﻿**Интерпретатор﻿** — паттерн поведения классов.
 
﻿**Назначение﻿**
 
Для заданного языка определяет представление его грамматики, а также интерпретатор предложений этого языка.

﻿**Применимость﻿**
 
Используйте паттерн интерпретатор в ситуациях, когда имеется интерпретируемый язык, конструкции которого можно представить в виде абстрактных синтаксических деревьев. Этот паттерн лучше всего работает в следующих случаях:
* грамматика проста. Для сложных грамматик иерархия классов становится слишком громоздкой и неуправляемой. В таких случаях лучше применять парсеры-генераторы, поскольку они могут интерпретировать выражения без построения абстрактных синтаксических деревьев, что экономит память (а возможно, и время);
* эффективность не является главным критерием. Наиболее эффективные интерпретаторы обычно не работают непосредственно с деревьями, а сначала транслируют их в другую форму. Так, регулярное выражение часто преобразуется в конечный автомат. Но даже в этом случае сам транслятор можно реализовать с помощью паттерна интерпретатор.

﻿**Отношения﻿**
 
* клиент строит (или получает в готовом виде) конструкцию в виде абстрактного синтаксического дерева, в узлах которого находятся объекты классов NonterminalExpression и TerminalExpression. Затем клиент инициализирует контекст и вызывает операцию Interpret;
* в каждом узле вида NonterminalExpression через операции Interpret определяется операция Interpret для каждого подвыражения. Для класса TerminalExpression операция Interpret определяет базу рекурсии;
* операции Interpret в каждом узле используют контекст для сохранения и доступа к состоянию интерпретатора.

﻿**Результаты﻿**
 
Основные достоинства и недостатки паттерна интерпретатор:
* простота изменения и расширения грамматики. Поскольку для представления грамматических правил в паттерне используются классы, то для изменения или расширения грамматики можно применять наследование. Существующие выражения можно модифицировать постепенно, а новые определять как вариации старых;
* простая реализация грамматики. Реализации классов, описывающих узлы абстрактного синтаксического дерева, похожи. Такие классы легко программируются, а зачастую они могут автоматически генерироваться генератором компиляторов или парсером-генератором;
* сложность сопровождения сложных грамматик. В паттерне интерпретатор определяется по меньшей мере один класс для каждого правила грамматики (для правил, определенных с помощью формы Бэкуса — Наура — BNF, может понадобиться и более одного класса). Поэтому сопровождение грамматики с большим числом правил иногда оказывается трудной задачей. Для ее решения могут быть применены другие паттерны (см. раздел «Реализация»). Но если грамматика очень сложна,
лучше прибегнуть к другим методам, например воспользоваться генератором компиляторов или парсером-генератором;
* добавление новых способов интерпретации выражений. Паттерн интерпретатор позволяет легко изменить способ вычисления выражений. Например, реализовать красивую печать выражения вместо проверки входящих в него типов можно, просто определив новую операцию в классах выражений. Если вам приходится часто создавать новые способы интерпретации выражений, подумайте о применении паттерна посетитель (379). Это поможет избежать изменения классов, описывающих грамматику.
